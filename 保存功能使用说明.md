# 预览界面保存功能使用说明

## 📋 功能概述

已将出图（保存）功能完全整合到预览界面中。现在你可以在调整好图片位置后，直接在预览窗口中保存图片，无需返回主界面。

---

## ✨ 新功能特点

### 1. **统一的保存按钮**
- 原来的两个按钮（"保存图片 (PNG)" 和 "保存图片 (PDF)"）已合并为一个 **"💾 保存图片"** 按钮
- 点击后会弹出功能完整的保存对话框

### 2. **多种文件格式支持**
- **PNG** - 高质量位图（推荐日常使用）
- **PDF** - 矢量格式（推荐论文投稿）
- **JPG** - 压缩位图（文件更小）
- **SVG** - 可编辑矢量（可在Illustrator等软件中编辑）
- **TIFF** - 无损位图（专业印刷）

### 3. **灵活的分辨率设置**
- **150 DPI** - 屏幕预览
- **300 DPI** - 标准打印（推荐）⭐
- **600 DPI** - 高质量打印
- **自定义** - 可输入任意DPI值（50-1200范围）

### 4. **高级选项**
- ✅ **自动裁剪白边** - 默认开启，去除图片周围多余空白
- ✅ **透明背景** - 仅PNG/SVG格式支持，适合叠加使用

---

## 🎯 使用步骤

### 步骤1：调整图片位置
1. 在预览窗口中使用方向键调整色带、比例尺、北箭的位置
2. 使用 `Tab` 键切换调整对象
3. 使用 `Shift + 方向键` 进行大幅移动
4. 满意后按 `S` 键保存位置设置（可选）

### 步骤2：打开保存对话框
点击右侧控制面板的 **"💾 保存图片"** 按钮

### 步骤3：选择保存选项

#### 文件格式选择
根据用途选择合适的格式：
- **论文投稿** → 选择 PDF
- **PPT演示** → 选择 PNG
- **网页使用** → 选择 JPG 或 PNG
- **后期编辑** → 选择 SVG
- **专业印刷** → 选择 TIFF

#### 分辨率设置
根据需求选择DPI：
- **屏幕查看** → 150 DPI
- **一般打印** → 300 DPI（推荐）
- **高质量打印** → 600 DPI
- **特殊需求** → 自定义DPI

#### 其他选项
- **自动裁剪白边**：建议保持勾选，可以去除图片周围多余空白
- **透明背景**：如果需要将图片叠加到其他背景上，可以勾选此选项

### 步骤4：选择保存位置
1. 点击 **"💾 保存"** 按钮
2. 在弹出的文件对话框中选择保存位置
3. 输入文件名
4. 点击"保存"

### 步骤5：确认保存成功
- 窗口底部状态栏会显示 "图片已保存: xxx.png"
- 弹出成功提示框，显示保存路径和参数信息

---

## 💡 使用技巧

### 技巧1：快速保存常用格式
如果你经常使用某种格式，可以：
1. 打开保存对话框
2. 选择你常用的格式和DPI
3. 直接点击保存

### 技巧2：同时保存多种格式
如果需要保存多种格式（如PNG和PDF）：
1. 第一次保存：选择PNG格式，保存
2. 再次点击"保存图片"按钮
3. 选择PDF格式，保存到同一位置

### 技巧3：高质量打印设置
如果需要高质量打印：
- 格式：PDF 或 TIFF
- DPI：600
- 自动裁剪白边：勾选
- 透明背景：不勾选

### 技巧4：网页使用优化
如果用于网页展示：
- 格式：JPG（文件更小）或 PNG（质量更好）
- DPI：150-300
- 自动裁剪白边：勾选

---

## 🔧 技术细节

### PNG格式优化
- 自动禁用iCCP配置文件，避免libpng警告
- 启用优化选项，减小文件大小
- 支持透明背景

### PDF格式特点
- 矢量格式，无限放大不失真
- 适合论文投稿和专业印刷
- 文件大小适中

### DPI说明
- **DPI** = Dots Per Inch（每英寸点数）
- 数值越高，图片越清晰，但文件越大
- 推荐设置：
  - 屏幕显示：72-150 DPI
  - 普通打印：300 DPI
  - 高质量打印：600 DPI

### 自动裁剪白边
- 使用 `bbox_inches='tight'` 参数
- 自动去除图片周围多余空白
- 保留 0.02 英寸的边距（pad_inches）

---

## 📊 格式对比表

| 格式 | 优点 | 缺点 | 推荐用途 |
|------|------|------|----------|
| **PNG** | 无损压缩、支持透明 | 文件较大 | 日常使用、PPT |
| **PDF** | 矢量格式、可编辑 | 不支持透明 | 论文投稿、印刷 |
| **JPG** | 文件小、兼容性好 | 有损压缩 | 网页、邮件 |
| **SVG** | 矢量、可编辑 | 兼容性一般 | 后期编辑 |
| **TIFF** | 无损、专业 | 文件很大 | 专业印刷 |

---

## ❓ 常见问题

### Q1: 保存的图片位置和预览不一致？
**A:** 请确保在调整位置后按 `S` 键保存位置设置。保存图片时会使用当前的位置调整参数。

### Q2: 如何保存高分辨率图片？
**A:** 选择 600 DPI 或使用自定义DPI输入更高的数值（最高1200）。

### Q3: PNG文件太大怎么办？
**A:** 可以尝试：
- 降低DPI（如从600降到300）
- 使用JPG格式（有损压缩）
- 使用PDF格式（矢量格式）

### Q4: 如何保存透明背景的图片？
**A:** 
1. 选择PNG或SVG格式
2. 勾选"透明背景"选项
3. 保存即可

### Q5: 自定义DPI有什么限制？
**A:** DPI必须在 50-1200 之间。超出此范围会提示错误。

---

## 🎨 完整工作流程示例

### 示例1：论文投稿
```
1. 调整图片位置 → 使用方向键微调
2. 保存位置设置 → 按 S 键
3. 打开保存对话框 → 点击"保存图片"
4. 选择格式 → PDF
5. 选择DPI → 300 DPI
6. 勾选自动裁剪白边
7. 保存 → 选择路径和文件名
```

### 示例2：PPT演示
```
1. 调整图片位置
2. 打开保存对话框
3. 选择格式 → PNG
4. 选择DPI → 150 DPI
5. 勾选自动裁剪白边
6. 勾选透明背景（如需要）
7. 保存
```

### 示例3：高质量打印
```
1. 调整图片位置
2. 打开保存对话框
3. 选择格式 → PDF 或 TIFF
4. 选择DPI → 600 DPI
5. 勾选自动裁剪白边
6. 保存
```

---

## 🔄 与主界面导出功能的区别

| 功能 | 预览界面保存 | 主界面导出 |
|------|-------------|-----------|
| **位置调整** | ✅ 实时预览 | ❌ 无法预览 |
| **格式选择** | ✅ 5种格式 | ⚠️ 需要分别设置 |
| **DPI设置** | ✅ 灵活选择 | ⚠️ 固定值 |
| **即时反馈** | ✅ 立即看到效果 | ❌ 需要重新生成 |
| **推荐使用** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |

**建议**：优先使用预览界面的保存功能，可以获得更好的体验和更精确的控制。

---

## 📝 更新日志

### v2.0 - 2025-10-31
- ✅ 合并PNG和PDF保存按钮为统一的"保存图片"按钮
- ✅ 新增保存对话框，支持5种文件格式
- ✅ 新增灵活的DPI设置（预设+自定义）
- ✅ 新增透明背景选项
- ✅ 优化PNG保存，自动禁用iCCP警告
- ✅ 改进用户界面，更直观易用

---

## 🎯 总结

新的保存功能将出图操作完全整合到预览界面中，提供了：
- ✅ **更直观的操作** - 调整完直接保存
- ✅ **更多的选择** - 5种格式、灵活DPI
- ✅ **更好的体验** - 一站式完成所有操作
- ✅ **更高的效率** - 无需返回主界面

享受新的保存功能吧！🎉

